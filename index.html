<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <link rel="ico" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>我的笔记</title>
    <link rel="stylesheet" href="/style.css" />
    <script src="./init/index.js" defer></script>
  </head>
  <body>
    <h1>关于</h1>
    <p>我的笔记，想到啥写啥。没什么样式，注重内容，不讲废话。</p>

    <h2>Dark Mode</h2>
    <p style="display: flex; align-items: center">
      <label for="darkMode">dark mode：</label>
      <input type="checkbox" id="darkMode" />
    </p>

    <script>
      const el = document.getElementById('darkMode')

      const { darkMode } = localStorage
      const isDarkMode = Boolean(Number(darkMode))
      if (isDarkMode) {
        document.body.style.cssText = `
            background-color: #222;
            color: #fff;
          `
        document.getElementById('darkMode').checked = true
      }

      el.addEventListener('change', e => {
        if (e.target.checked) {
          localStorage.darkMode = 1
          document.body.style.cssText = `
            background-color: #222;
            color: #fff;
          `
        } else {
          localStorage.darkMode = 0
          document.body.style.cssText = `
            background-color: #fff;
            color: #222;
          `
        }
      })
    </script>

    <h2>操作备忘</h2>
    <ol>
      <li>
        尖括号：
        <code ab>* ab</code>
        ...
        <code ab>/*</code>
      </li>

      <li>
        代码块：
        <code ab>script src</code>
        ...
        <code ab>/script</code>
      </li>
    </ol>

    <h1>纯函数</h1>
    一些有用的工具方法

    <h2>JS</h2>

    <h3>常用正则</h3>

    <h4>匹配所有 HTML 标签</h4>
    <script src>
      /**
       * 匹配并替换所有标签
       * 不兼容 IE
       */
      const replaceHtmlTag = text => {
        const re = /<[^>]+>/gim
        return text.replaceAll(re, '')
      }
    </script>

    <h2>DOM</h2>
    跟操作 DOM 或事件相关。

    <h3>根据 hn 标签生成目录序号</h3>
    比如这个文档的 h1 ~ h6 标签前面的章节条数。

    <h4>代码</h4>
    <script src>
      const nodes = document.querySelectorAll('h1,h2,h3,h4,h5,h6')

      function insertTitle(node, num) {
        node.innerHTML = `${num} ${node.innerHTML}`
      }

      let hn = []

      for (let i = 0; i < nodes.length; i++) {
        const n = Number(nodes[i].tagName[1])
        if (n > hn.length) {
          if (n - hn.length > 1) {
            alert(`标题级别设置错误：${nodes[i].innerHTML}`)
            throw new Error(`标题级别设置错误：${nodes[i].innerHTML}`)
          }
          hn.push(1)
        } else {
          temp = hn[n - 1] + 1
          hn = [...hn.slice(0, n - 1), temp]
        }
        insertTitle(nodes[i], hn.join('.'))
      }
    </script>

    <h4>注意</h4>
    目录级别要“连贯”，不能 h1 后直接跟 h3。

    <h3>元素拖拽功能封装</h3>
    一组事件，为元素赋予拖拽能力。
    <h4>代码</h4>
    <script src>
      function letElementDragble(selector) {
        let dEl = null
        if (typeof selector === 'string') {
          dEl = document.querySelector(selector)
        } else {
          dEl = selector
        }

        let differX = 0
        let differY = 0

        function mouseMoveHandler(e) {
          dEl.style.cssText = `
            position: fixed;
            left: ${e.clientX - differX}px;
            top: ${e.clientY - differY}px;
          `
        }

        dEl.addEventListener('mousedown', e => {
          const { left, top } = dEl.getBoundingClientRect()

          dEl.style.cssText = `
            cursor: move;
            position: fixed;
            left: ${left}px;
            top: ${top}px;
          `

          differX = e.clientX - left
          differY = e.clientY - top

          window.removeEventListener('mousemove', mouseMoveHandler)
          window.addEventListener('mousemove', mouseMoveHandler)
        })

        window.addEventListener('mouseup', () => {
          window.removeEventListener('mousemove', mouseMoveHandler)
        })

        window.addEventListener('mouseleave', () => {
          window.removeEventListener('mousemove', mouseMoveHandler)
        })

        window.addEventListener('focus', () => {
          window.removeEventListener('mousemove', mouseMoveHandler)
        })
      }

      // <button id="dragBtn">按</button>
      letElementDragble('#dragBtn')
    </script>
    <h4>演示</h4>
    <button id="dragBtn">拖我</button>
    <script>
      function letElementDragble(selector) {
        const dEl = document.querySelector(selector)

        let differX = 0
        let differY = 0

        function mouseMoveHandler(e) {
          dEl.style.cssText = `
            position: fixed;
            left: ${e.clientX - differX}px;
            top: ${e.clientY - differY}px;
          `
        }

        dEl.addEventListener('mousedown', e => {
          const { left, top } = dEl.getBoundingClientRect()

          dEl.style.cssText = `
            cursor: move;
            position: fixed;
            left: ${left}px;
            top: ${top}px;
          `

          differX = e.clientX - left
          differY = e.clientY - top

          window.removeEventListener('mousemove', mouseMoveHandler)
          window.addEventListener('mousemove', mouseMoveHandler)
        })

        window.addEventListener('mouseup', () => {
          window.removeEventListener('mousemove', mouseMoveHandler)
        })

        window.addEventListener('mouseleave', () => {
          window.removeEventListener('mousemove', mouseMoveHandler)
        })

        window.addEventListener('focus', () => {
          window.removeEventListener('mousemove', mouseMoveHandler)
        })
      }

      // <button id="dragBtn">按</button>
      letElementDragble('#dragBtn')
    </script>

    <h4>注意</h4>
    手机上用不了

    <h1>编码</h1>
    一些提升编码效率的工具和方法

    <h2>Prettier</h2>

    <h3>常用配置</h3>
    <script src>
      /**
       * .prettierrc 配置文件速查
       * 配置项文档：https://prettier.io/docs/en/options.html
       *
       * 以下是常用项简介：
       * printWidth: 100, // 行宽
       * tabWidth: 2, // tab 宽
       * useTabs: false, // 空格用 tab 吗？
       * semi: false, // 加分号吗？
       * singleQuote: true, // 用但引号吗？
       * quoteProps: 'as-needed', // 对象属性名引号添加规则: "": "<必要时|有一则全|不管>"
       * jsxSingleQuote: false, // 在 JSX 中用单引号吗？
       * trailingComma: 'all', // 数组、对象的尾逗号
       * bracketSpacing: true, // 对象收尾加空格吗？ {name: 1} => { name: 1 }
       * bracketSameLine: true, // 是否将属性过多的标签中的 ">" 不换行放置？
       * arrowParens: 'avoid', // 箭头函数函参都要有括号包裹吗？
       * vueIndentScriptAndStyle: true, // vue-sfc script 缩进
       * endOfLine: 'lf', //
       */

      ;({
        printWidth: 100,
        tabWidth: 2,
        useTabs: false,
        semi: false,
        singleQuote: true,
        quoteProps: 'as-needed',
        jsxSingleQuote: false,
        trailingComma: 'all',
        bracketSpacing: true,
        bracketSameLine: true,
        arrowParens: 'avoid',
        vueIndentScriptAndStyle: true,
        endOfLine: 'lf',
      })
    </script>

    <h2>CSS 片段</h2>

    <h3>样式重置</h3>

    <h4>经典款</h4>
    <script src>
      /* http://meyerweb.com/eric/tools/css/reset/
        v2.0 | 20110126
        License: none (public domain)
      */

      /*

       html, body, div, span, applet, object, iframe,
       h1, h2, h3, h4, h5, h6, p, blockquote, pre,
       a, abbr, acronym, address, big, cite, code,
       del, dfn, em, img, ins, kbd, q, s, samp,
       small, strike, strong, sub, sup, tt, var,
       b, u, i, center,
       dl, dt, dd, ol, ul, li,
       fieldset, form, label, legend,
       table, caption, tbody, tfoot, thead, tr, th, td,
       article, aside, canvas, details, embed,
       figure, figcaption, footer, header, hgroup,
       menu, nav, output, ruby, section, summary,
       time, mark, audio, video {
       	margin: 0;
       	padding: 0;
       	border: 0;
       	font-size: 100%;
       	font: inherit;
       	vertical-align: baseline;
       }
       article, aside, details, figcaption, figure,
       footer, header, hgroup, menu, nav, section {
       	display: block;
       }
       body {
       	line-height: 1;
       }
       ol, ul {
       	list-style: none;
       }
       blockquote, q {
       	quotes: none;
       }
       blockquote:before, blockquote:after,
       q:before, q:after {
       	content: '';
       	content: none;
       }
       table {
       	border-collapse: collapse;
       	border-spacing: 0;
       }

       */
    </script>

    <h1>UI 库</h1>

    <h2>Ant Design Vue</h2>
    Andv 组件用法

    <h3>1.x</h3>

    <h4>分页器 a-pagination</h4>

    <h5>代码</h5>
    <script src>
      /*
        <a-pagination
          showSizeChanger
          @showSizeChange="onSearch"
          :size="form.size"
          :default-current="1"
          :total="dataListObj.totalRows"
          :pageSize="dataListObj.pageSize"
          @change="onSearch"
          v-model="form.page"
        />
      */
    </script>

    <h5>注意</h5>
    <ol>
      <li>size: string</li>
      <li>@showSizeChange: (page = 1, size) => void</li>
      <li>onSearch 的函参只用来传递(page, size)</li>
    </ol>

    <h5>a-table 中的 pagination</h5>
    <script src="">
      /*
        <a-table
          :pagination="{
            pageSize: form.size,
            current: form.page,
            defaultPageSize: 1,
            total: form.total,
            showSizeChanger: true,
            showQuickJumper: true,
            pageSizeOptions: ['10', '20', '30', '40', '50', '100', '200']
          }"
        />
      */
    </script>

    <h2>Vuetify</h2>

    <h3>官网</h3>
    <a href="https://vuetifyjs.com/zh-Hans/" target="_blank">Vuetify 官网</a>

    <h2>Naive UI</h2>
    <h3>官网</h3>
    <a href="https://www.naiveui.com/zh-CN" target="_blank">Naive UI</a>
  </body>
</html>
